# HOA Cash Flow Statement Generator

## 1. Project Overview

The HOA Cash Flow Statement Generator is a desktop application designed to help Homeowners Associations (HOAs) easily create, manage, and distribute their monthly cash flow statements. It allows for straightforward data entry, automatic calculations, and exporting to common document formats (PDF, DOCX), as well as direct emailing of statements.

This application aims to simplify financial reporting for HOA treasurers and board members, ensuring accuracy and transparency.

## 2. Features

*   **User-Friendly Interface:** Intuitive GUI built with CustomTkinter for a modern look and feel.
*   **Data Entry for Cash Flow Items:**
    *   Dedicated fields for beginning cash balances (bank and on-hand).
    *   Categorized cash inflow items (monthly dues, certifications, fees, rentals, solicitations, interest, livelihood, others).
    *   Categorized cash outflow items (snacks, transportation, office supplies, printing, labor, billboard, cleaning, misc. expenses, federation fees, uniforms, BOD meetings, general assembly, cash deposits, withholding tax, refunds, others).
*   **Automatic Calculations:**
    *   Total receipts (inflows).
    *   Total cash outflows.
    *   Ending cash balance.
    *   Breakdown of ending cash (bank and on-hand).
*   **Date Management:**
    *   Easy date selection for the reporting period using an interactive calendar.
    *   Date displayed in a user-friendly format.
*   **Document Export:**
    *   Export cash flow statements to **PDF** format for easy sharing and archiving.
    *   Save cash flow statements as **Microsoft Word (DOCX)** files for editing or record-keeping.
*   **Document Import/Loading:**
    *   Load data from previously saved PDF or DOCX cash flow statements generated by this application, pre-filling the fields.
*   **Email Integration:**
    *   Send generated cash flow statements (PDF and Word attachments) directly via email (uses Gmail SMTP).
    *   Configurable sender email credentials and recipient email addresses.
*   **Customizable Header Information:**
    *   Set a custom header address for official documents.
    *   Include a custom logo image in the header of exported documents.
*   **Signatory Fields:**
    *   Designated fields for "Prepared by (Treasurer)", "Checked by (Auditor)", and two "Noted by" (e.g., President, CHUDD HCD-CORDS) individuals, which are included in exported documents.
*   **Secure Login:**
    *   Application access is protected by a username and password.
    *   Credentials can be managed via a settings panel.
*   **Settings Management:**
    *   Configure sender email, sender email password (app password recommended for Gmail), application username, and application password.
    *   Settings are saved locally in the user's AppData folder for persistence.
*   **Footer Customization:**
    *   Includes predefined footer images (CHUDD and XU logos) on the application's main window.
*   **Keyboard Shortcuts:**
    *   `Ctrl+L`: Load document
    *   `Ctrl+E`: Export PDF
    *   `Ctrl+W`: Save Word
    *   `Ctrl+G`: Send Email
    *   `Ctrl+Q`: Quit application
*   **Clear Fields Functionality:** Easily reset all financial input fields.

## 3. Prerequisites for Running the Application (for End-Users)

Before installing and running the HOA Cash Flow Statement Generator, please ensure your system meets the following requirements:

*   **Operating System:** Windows (e.g., Windows 10, Windows 11).
*   **Ghostscript (CRITICAL for PDF Data Loading):**
    *   For the application to correctly load data from *some* PDF files (specifically for advanced table extraction from previously generated statements), Ghostscript **must** be installed on your computer.
    *   The `bin` directory of your Ghostscript installation must be added to your system's **PATH environment variable**.
    *   **Download:** Get Ghostscript from [www.ghostscript.com/download/gsdnld.html](https://www.ghostscript.com/download/gsdnld.html) (the AGPL release suitable for your system, usually 64-bit).
    *   **Installation:** During Ghostscript installation, if there's an option to "add to PATH" or "modify environment variables," please select it. Otherwise, you may need to add it manually.
    *   *Note: If Ghostscript is not properly installed and configured in the PATH, the "Load from PDF" feature may not work correctly for all PDF types, though other application features will remain functional.*

## 4. Installation Instructions (for End-Users)

To install the HOA Cash Flow Statement application using the provided installer (`HOA_Cash_Flow_Setup.exe` or similar):

1.  **Download the Installer:** Obtain the `setup.exe` file.
2.  **Run the Installer:** Double-click the `setup.exe` file.
3.  **User Account Control (UAC):** If prompted, click "Yes" to allow the installer to make changes.
4.  **Follow the Wizard:**
    *   Click "Next" on the welcome screen.
    *   Accept the default installation location (usually `C:\Program Files\HOA Cash Flow Statement`) or choose a custom one, then click "Next."
    *   Confirm the Start Menu folder name and click "Next."
    *   Choose additional tasks like creating a desktop icon (optional) and click "Next."
    *   Review the settings and click "Install."
    *   Wait for the installation to complete.
    *   Click "Finish." You can choose to launch the application immediately if the option is available.

## 5. Usage Guide

1.  **Launch the Application:**
    *   Use the desktop shortcut (if created) or find "HOA Cash Flow Statement" in your Start Menu.
2.  **Login:**
    *   Enter the configured username and password.
    *   Default credentials (if not changed in settings):
        *   Username: `user`
        *   Password: `123`
3.  **Main Window Overview:**
    *   **Header Configuration (Top Section):**
        *   **Header Address:** Enter the official address for your HOA.
        *   **Header Logo:** Click "Select Logo Image" to choose a logo file (`.png`, `.jpg`) for your documents.
        *   **Settings:** Click "Manage Settings" to change login credentials, sender email, and sender email app password.
        *   **Report Date:** Click the date button to select the reporting month/period using the calendar.
    *   **Financial Data Entry (Middle Columns):**
        *   **Beginning Cash Balances:** Enter cash in bank and cash on hand at the start of the period.
        *   **Cash Inflows:** Enter amounts for various income categories.
        *   **Cash Outflows:** Enter amounts for various expense categories.
        *   **Ending Cash Balances & Totals (Calculated):** These fields will update automatically as you enter data.
    *   **Action Buttons (Below Financial Columns):**
        *   **Load (Ctrl+L):** Load data from a previously saved DOCX or PDF statement (generated by this app).
        *   **Clear Fields:** Reset all financial input fields.
        *   **Export PDF (Ctrl+E):** Save the current statement as a PDF file.
        *   **Save Word (Ctrl+W):_** Save the current statement as a DOCX file.
        *   **Email (Ctrl+G):** Send the statement as PDF and Word attachments via email.
    *   **Signatories & Email (Bottom Section):**
        *   **Recipients:** Enter comma-separated email addresses for sending the statement.
        *   **Prepared by, Noted by, Checked by:** Enter the names of the respective signatories.
4.  **Entering Data:**
    *   Click into an input field and type the numerical amount. Commas will be formatted automatically for display.
5.  **Saving and Exporting:**
    *   Use the "Export PDF" or "Save Word" buttons to generate documents. You will be prompted to choose a save location and filename.
6.  **Sending Emails:**
    *   Ensure your sender email and app password are correctly configured in "Manage Settings." (For Gmail, an "App Password" is required, not your regular Gmail password).
    *   Enter recipient emails.
    *   Click the "Email (Ctrl+G)" button. The application will generate PDF and Word versions and attach them to the email.
7.  **Changing Settings:**
    *   Click "Manage Settings."
    *   Update sender email, sender password (app password for Gmail), application username, and application password.
    *   Click "Save." Changes to login credentials will take effect the next time you log in.

---

## 6. Development Setup (For Developers)

If you wish to run or modify the application from the source code:

1.  **Prerequisites:**
    *   Python 3.9 or higher (developed with 3.13).
    *   Pip (Python package installer).
    *   Git (optional, for cloning).
    *   Ghostscript (see section 3 for details, required for `camelot-py`).

2.  **Clone the Repository (Optional):**
    ```bash
    git clone <repository_url>
    cd <repository_folder>
    ```
    Or, download and extract the source code archive.

3.  **Create a Virtual Environment (Recommended):**
    ```bash
    python -m venv venv_hoa
    ```
    Activate it:
    *   Windows: `venv_hoa\Scripts\activate`
    *   macOS/Linux: `source venv_hoa/bin/activate`

4.  **Install Dependencies:**
    ```bash
    pip install -r requirements.txt
    ```
    If `requirements.txt` is not provided, install manually:
    ```bash
    pip install customtkinter Pillow tkcalendar reportlab python-docx pdfplumber camelot-py[cv] PyMuPDF
    ```
    *(Note: `camelot-py[cv]` installs OpenCV. `PyMuPDF` provides `fitz`.)*

5.  **Place Assets:**
    *   Ensure `chud logo.png` and `xu logo.png` are in the root project directory (or adjust `resource_path` usage if placed elsewhere).

6.  **Run the Application:**
    ```bash
    python main.py
    ```

## 7. Creating a Distributable Installer (For Developers)

This project uses PyInstaller to bundle the Python application and Inno Setup to create a Windows installer.

**A. PyInstaller - Bundling the Application:**

1.  **Install PyInstaller:**
    (If not already done in your development virtual environment)
    ```bash
    pip install pyinstaller
    ```
2.  **Prepare Assets:**
    *   Ensure `chud logo.png`, `xu logo.png`, and an optional `your_icon.ico` (for the executable) are in the root of your project directory (where `main.py` and `main.spec` reside).
    *   The `gui_components.py` file uses a `resource_path` function to correctly locate these assets when bundled.
3.  **Use the `.spec` File:**
    *   A `main.spec` file is provided (or should be created) to configure the PyInstaller build. This file lists hidden imports, data files (assets), and other build parameters.
    *   **Key parts of `main.spec`:**
        *   `Analysis(['main.py'], ...)`: Specifies the main script.
        *   `datas=[('chud logo.png', '.'), ('xu logo.png', '.'), ... ]`: Includes image assets. Also includes CustomTkinter themes via the `get_customtkinter_assets()` helper function in the spec.
        *   `hiddenimports=[...]`: Lists modules PyInstaller might miss.
        *   `exe = EXE(..., name='HOA_Cash_Flow', console=False, icon='your_icon.ico')`: Defines the executable properties. `console=False` for GUI apps.
4.  **Build with PyInstaller:**
    *   Ensure your virtual environment is active.
    *   Navigate to your project directory in the terminal.
    *   Run:
        ```bash
        pyinstaller main.spec
        ```
    *   This creates a `build/` folder and a `dist/` folder.
    *   Your bundled application will be in `dist/HOA_Cash_Flow/` (this is a one-directory build, which is recommended for Inno Setup).

**B. Inno Setup - Creating the Windows Installer:**

1.  **Install Inno Setup:**
    *   Download and install Inno Setup from [jrsoftware.org](http://www.jrsoftware.org/isinfo.php).
2.  **Create/Use an Inno Setup Script (`.iss` file):**
    *   An example script (`HOA_Cash_Flow_Installer.iss` or similar) should be used.
    *   Launch Inno Setup Compiler and open/create your `.iss` script.
    *   **Key sections in the `.iss` script:**
        *   `[Setup]`:
            *   `AppId`: **Generate a new unique GUID** using Tools > Generate GUID in Inno Setup.
            *   `AppName`, `AppVersion`, `AppPublisher`.
            *   `DefaultDirName={autopf}\{#MyAppName}`: Installs to Program Files.
            *   `PrivilegesRequired=admin`: Requires admin rights for installation.
            *   `OutputDir`: Specifies where the `setup.exe` will be saved.
            *   `SetupIconFile`: Optional icon for the installer itself.
        *   `[Files]`:
            *   **`Source: "dist\HOA_Cash_Flow\*"; DestDir: "{app}"; Flags: ignoreversion recursesubdirs createallsubdirs`**
                *   This line is crucial. It tells Inno Setup to copy *all* files and subfolders from your PyInstaller output directory (`dist/HOA_Cash_Flow/`) into the user's installation directory (`{app}`).
                *   Ensure the `Source` path is correct relative to your `.iss` file.
        *   `[Icons]`: Defines Start Menu and Desktop icons.
        *   `[Run]`: Option to launch the app after installation.
        *   `[UninstallDelete]`: Defines files/folders to remove on uninstall.
3.  **Compile the Installer:**
    *   In Inno Setup, go to **Build > Compile**.
    *   This will generate your `HOA_Cash_Flow_Setup.exe` (or similar) in the `OutputDir` specified in your `.iss` script.

4.  **Distribute:**
    *   Distribute the generated `setup.exe` file to your end-users.
    *   **Crucially, inform users about the Ghostscript prerequisite (see Section 3).**

## 8. Troubleshooting

*   **`ModuleNotFoundError` during PyInstaller build or app run:**
    *   Ensure the module is installed in your active virtual environment (`pip install <module_name>`).
    *   Add the module to `hiddenimports` in `main.spec` and rebuild.
*   **Assets (images, themes) not found in bundled app:**
    *   Verify `datas` in `main.spec` correctly includes the assets and their destination paths.
    *   Ensure `resource_path()` (in `gui_components.py`) is used for loading assets within the code.
*   **"Failed to save settings: [Errno 13] Permission denied" after installation:**
    *   This typically means the application is trying to write `settings.json` to a protected location (like Program Files).
    *   The `setting.py` file has been designed to save `settings.json` to the user's `AppData\Local\YourAppNameSettings` folder, which is writable. Ensure you are using this updated version.
*   **PDF Loading Issues (Camelot/Ghostscript):**
    *   This is almost always due to Ghostscript not being installed or its `bin` directory not being in the system PATH. Verify the Ghostscript installation on the user's machine.
*   **Inno Setup "File not found" during compilation:**
    *   Double-check the `Source` paths in the `[Files]` section of your `.iss` script. They must correctly point to the output of your PyInstaller build, relative to the location of the `.iss` file.

## 9. Contributing (Optional)

If you wish to contribute to this project:
1. Fork the repository.
2. Create a new branch (`git checkout -b feature/YourFeature`).
3. Make your changes.
4. Commit your changes (`git commit -m 'Add some feature'`).
5. Push to the branch (`git push origin feature/YourFeature`).
6. Open a Pull Request.

## 10. License (Optional)

This project is licensed under the [MIT License](LICENSE.txt) - see the LICENSE.txt file for details.
*(Create a LICENSE.txt file with the MIT license text if you choose this license, or specify another).*

---
